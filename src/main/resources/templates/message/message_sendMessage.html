<div id="message_section">
    <div id="table1" th:if="${list!=null}">
        <div id="table2">
            <table class="col-100 col">
                <colgroup>
                    <col width="10%">
                    <col width="20%">
                    <col width="*%">
                    <col width="*%">
                </colgroup>
                <thead>
                <tr>
                    <th></th>
                    <th>no</th>
                    <th>받은사람</th>
                    <th>내용</th>
                    <th>읽음여부</th>
<!--                <th>발송취소</th>-->
                </tr>
                </thead>
                <tbody th:each="mv:${list}">
                <tr>
                    <td>
                        <div class="checkbox2 m-0">
                            <input id="check2" type="checkbox">
                            <label for="check2">
                            </label>
                        </div>
                    </td>
                    <td class="msgNo" th:text="${mv.MSG_NO}" ></td>
                    <td th:text="${mv.RECV_MEMBER}"></td>
                    <td th:text="${mv.MSG_CONTENT}"></td>
                    <td th:utext="${mv.READ_CHECK.toString()} eq '0001-01-01 00:00:00.0'? '<input type=\'button\' id=\'cancel\' value=\'발송취소\' onclick=\'cancelMsg(' + ${mv.MSG_NO} + ')\'/>':${mv.READ_CHECK}" ></td>
<!--                    <td th:text="${ch.DEL_STATUS} eq 0?'N':'Y'"></td>-->

                </tr>
                </tbody>
            </table>
<!--            <button class="msg-cancel"></button>-->
            <div>
                <form id="deleteMsg" type="post" action="message/moveBlock">
                    <input id="delMsgNo" name="msgNo" type="hidden" value="-1"/>
                    <input type="button" class="delete-message" value="삭제" onclick="fn_move_Block();">
                </form>
            </div>

        </div>
    </div>
</div>
<script>
    function fn_move_Block() {
        if (confirm("휴지통으로 이동시키겠습니까?")) {
            $('.targetChk').each(function () {
                if ($(this).is(':checked')) {
                    var msgNo = $(this).closest('tr').children('.msgNo').html();
                    var loc = getContextPath()+"/message/moveBlock";
                    $('#deleteMsg').attr("action", loc);
                    $('#delMsgNo').val(msgNo);
                    $('#deleteMsg').submit();
                }
            });
        } else alert("삭제안한다");
    }
    function deleteMsg() {
        if (confirm("휴지통으로 이동시키겠습니까?")) {
            $('.targetChk').each(function () {
                if ($(this).is(':checked')) {
                    var msgNo = $(this).closest('tr').children('.msgNo').html();
                    $.ajax({
                        url: getContextPath() + "/message/moveBlock",
                        data: {"msgNo": msgNo},
                        type: 'POST',
                    }).done(function () {
                        alert("휴지통으로 이동합니다.");
                        fn_message_move('block');
                        //$("#target").html(fragment);
                    });
                }
            });
        }
    }
</script>
<script th:src="@{/js/message/message_js_sh.js}"></script>
<script src="http://code.jquery.com/jquery-3.6.0.min.js"></script>