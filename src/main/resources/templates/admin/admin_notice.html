<div id="admin_section">
    <div id="admin_page_title">공지사항 관리</div>
    <div id="admin_content">
        <table id="notice_table" th:if="${list!=null}">
            <thead>
            <tr >
                <th>번호</th>
                <th>게시판종류</th>
                <th>제목</th>
                <th>등록날짜</th>
                <th>게시여부</th>
            </tr>
            </thead>
            <!-- 페이징처리 전에 map으로 가져왔던 것 -->
<!--             <tbody>
            	<tr th:each="n : ${list}">
            		<td>1</td>
            		<td th:text="${n.CATEGORY_NAME}"></td>
            		<td th:text="${n.NOTICE_TITLE}" name="moveToView" th:title="${n.NOTICE_NO}">
						<a th:href="@{/admin/noticeView(no=${n.NOTICE_NO})}" ></a>
					</td>
            		<td th:text="${#dates.format(n.NOTICE_DATE,'yyyy-MM-dd')}"></td>
            		<td th:text="${n.NOTICE_STATUS} eq 0?'게시중':'삭제'"></td>
                </tr>
            </tbody> -->
	        <tbody>
	        	<tr th:each="n : ${list}">
	        		<td th:text="${n.noticeNo}"></td>
	        		<td th:text="${n.categoryNo}"></td>
	        		<td th:text="${n.noticeTitle}" name="moveToView" th:title="${n.noticeNo}">
			<!-- <a th:href="@{/admin/noticeView(no=${n.NOTICE_NO})}" ></a> -->
					</td>
	        		<td th:text="${#dates.format(n.noticeDate,'yyyy-MM-dd')}"></td>
	        		<td th:text="${n.noticeStatus} eq 0?'게시중':'삭제'"></td>
	            </tr>
	        </tbody>    
        </table>
        <div id="admin_pagebar">
			<!-- 이전 -->
        	<div>
        		<a th:if="${cPage} eq 1" >&lt;</a>
        		<a href="#" th:unless="${cPage} eq 1" th:onclick="|fn_ajax_paging('${cPage-1}')|">&lt;</a>
       		</div>
       		<!-- th:onclick="${1==cPage}?'|javascript:fn_ajax_paging();|':'|javascript:fn_ajax_paging();|'" -->
       		<!-- 페이지블록 -->
       		<th:block th:each="n:${#numbers.sequence(startpage,endpage)}">
	        <div th:if="${cPage eq n}" style="background-color: #F77B1E;color:white;text-decoration:underline;">
	        	<!-- <a th:href="@{/admin/notice(page=${n-1})}" th:text="${n}">1</a> -->
	        	<a th:onclick="|fn_ajax_paging('${n}')|" th:text="${n}" >1</a>
        	</div>
        	<div th:unless="${cPage eq n}">
        		<a  href="#" th:onclick="|fn_ajax_paging('${n}')|" th:text="${n}">1</a>
        	</div>
        	</th:block>
        	<!-- 다음 -->
	        <div>
	        	<a th:if="${endpage==cPage}">&gt;</a>
	        	<a href="#" th:unless="${endpage==cPage}" th:onclick="|fn_ajax_paging('${cPage+1}')|">&gt;</a>
        	</div>
        
        
<!--         	<ul class="pagination justify-content-center">
		  1페이지일대 이전 불가
		    <li class="page-item" th:classappend="${1==cPage}?'disabled'">
		      <a class="page-link" href="#" th:href="@{/admin/notice(page=${cPage})}"tabindex="-1" aria-disabled="true">Previous</a>
		    </li>
		    
		    th:classappend => true일때만 class적용하기, i와 현재페이지가 같을 때 disabled적용
		    <li class="page-item " th:classappend="${i==cPage}?'disabled'" th:each="i :${#numbers.sequence(startpage,endpage)}">
		    	<a class="page-link" href="#" th:href="@{/admin/notice(page=${i-1})}" th:text="${i}">1</a>
	    	</li>
	    	
	    	마지막페이지일때 다음 불가
		    <li class="page-item" th:classappend="${list.totalPages==cPage}?'disabled'">
		      <a class="page-link" href="#" th:href="@{/admin/notice(page=${list.pageable.pageNumber+1})}">Next</a>
		    </li>
		  </ul> -->
        </div>
        	<button class="admin_buttons" onclick="fn_notice_write();">작성하기</button>
    </div>
</div>
<script th:inline="javascript">
	//페이지바 설정하기 (현재페이지 보여주기)
	var cPage=[[${cPage}]];
	console.log(cPage);

	
	//ajax 페이징처리
	function fn_ajax_paging(i){
		$.ajax({
			url:"/admin/notice",
			data:{
				"page":i-1
			}
		}).done(function(fragment){
			$("#target").html(fragment);
		});
	};
	
	//공지사항 view 이동
	$("[name=moveToView]").click((e)=>{
		const no=e.target.title;
		console.log(no);
		$.ajax({
			url:"/admin/noticeView",
			data:{"no":no}
		}).done(function (fragment){
			$("#target").html(fragment);
		});
	});
</script>
